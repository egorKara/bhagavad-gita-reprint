# üåê Nginx –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ "–ë—Ö–∞–≥–∞–≤–∞–¥-–ì–∏—Ç–∞ –∫–∞–∫ –æ–Ω–∞ –µ—Å—Ç—å".

---

## üìÅ **–§–∞–π–ª—ã –≤ —ç—Ç–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ**

### **‚úÖ main.conf** 
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∞–π—Ç–∞ `gita-1972-reprint.ru`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üîí **HTTPS —Å Let's Encrypt** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- üîÑ **HTTP ‚Üí HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç**
- üìÅ **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã** –∏–∑ `/var/www/gita-1972-reprint/public`
- üíæ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (30 –¥–Ω–µ–π)
- üõ°Ô∏è **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** (HSTS, X-Frame-Options –∏ –¥—Ä.)
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

### **üóëÔ∏è api.conf** *(–£–î–ê–õ–ï–ù)*
**–ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è:** –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ HTTP, –±–µ–∑ SSL)

---

## üöÄ **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**

1. **–û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç:** `docs/nginx/main.conf`
2. **API —Å–µ—Ä–≤–µ—Ä:** `deployment/nginx-ssl.conf` ‚úÖ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

---

## ‚öôÔ∏è **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**

### **1. –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç:**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo cp docs/nginx/main.conf /etc/nginx/sites-available/gita-1972-reprint.ru

# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–π—Ç–∞
sudo ln -sf /etc/nginx/sites-available/gita-1972-reprint.ru /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ nginx
sudo systemctl reload nginx
```

### **2. API —Å–µ—Ä–≤–µ—Ä:**
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo cp deployment/nginx-ssl.conf /etc/nginx/sites-available/api.gita-1972-reprint.ru

# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–π—Ç–∞
sudo ln -sf /etc/nginx/sites-available/api.gita-1972-reprint.ru /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo nginx -t && sudo systemctl reload nginx
```

---

## üîí **SSL –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**

### **–ü–æ–ª—É—á–µ–Ω–∏–µ Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ certbot
sudo apt-get install -y certbot python3-certbot-nginx

# –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç
sudo certbot --nginx -d gita-1972-reprint.ru --non-interactive --agree-tos -m admin@gita-1972-reprint.ru

# API —Å–∞–π—Ç
sudo certbot --nginx -d api.gita-1972-reprint.ru --non-interactive --agree-tos -m admin@gita-1972-reprint.ru
```

### **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:**
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
echo "0 12 * * * /usr/bin/certbot renew --quiet" | sudo crontab -
```

---

## üõ°Ô∏è **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

### **–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –≤–∫–ª—é—á–µ–Ω—ã:**
- üîí **TLS 1.2/1.3** —Ç–æ–ª—å–∫–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
- üõ°Ô∏è **HSTS** –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS
- üö´ **X-Frame-Options DENY** –∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking
- üîí **X-Content-Type-Options nosniff** –∑–∞—â–∏—Ç–∞ –æ—Ç MIME sniffing
- üõ°Ô∏è **XSS Protection** –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç XSS

### **–î–ª—è API –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- üåê **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º
- ‚è±Ô∏è **–¢–∞–π–º–∞—É—Ç—ã** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è
- üìä **Rate limiting** (–≤ deployment –≤–µ—Ä—Å–∏–∏)

---

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

### **–õ–æ–≥–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤:**
```
/var/log/nginx/gita-main-access.log    # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç (–¥–æ—Å—Ç—É–ø)
/var/log/nginx/gita-main-error.log     # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç (–æ—à–∏–±–∫–∏)
/var/log/nginx/api.gita-access.log     # API (–¥–æ—Å—Ç—É–ø)
/var/log/nginx/api.gita-error.log      # API (–æ—à–∏–±–∫–∏)
```

### **–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ nginx
sudo systemctl status nginx

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -T

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞
sudo systemctl reload nginx

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo tail -f /var/log/nginx/*.log
```

---

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**

1. **üîß –ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω—ã —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
   - –ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –ø—Ä–æ–µ–∫—Ç–∞

2. **üìÅ –ü—É—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö:**
   - –ü—Ä–æ–µ–∫—Ç: `/var/www/gita-1972-reprint`
   - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã: `/var/www/gita-1972-reprint/public`
   - API: `http://127.0.0.1:3000`

3. **üöÄ –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `deployment/install-service.sh`
   - –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üîó **–°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

- üìã **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:** `deployment/README.md`
- üö® **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:** `deployment/SERVER_FIX_INSTRUCTIONS.md`
- üéõÔ∏è **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º:** `deployment/server-dashboard.sh`
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** `deployment/health-check.sh`

---

## ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚úÖ `https://gita-1972-reprint.ru` ‚Üí –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç
- ‚úÖ `https://api.gita-1972-reprint.ru` ‚Üí API —Å–µ—Ä–≤–µ—Ä
- ‚úÖ `http://gita-1972-reprint.ru` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã
- ‚úÖ –í—Å–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è

**üéâ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**
